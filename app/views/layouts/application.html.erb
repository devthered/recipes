<!DOCTYPE html>
<html>
  <head>
    <title>Recipe Cards</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
  </head>

  <body data-no-turbolink="true">
    <header>
      <div class="container">
        <div class="row">
          <p class="logo"><%= link_to 'Recipe Cards', root_url %></p>
          <% if logged_in? %>
            <button class="nav-button right visible-xxs dropdown">
              <%= image_tag asset_path('sandwich.png'), alt: 'Menu', title: 'Menu' %>
              <div class="dropdown-content">
                <%= link_to 'Recipes', recipes_path %>
                <%= link_to 'Users', users_path %>
                <%= link_to 'Me', current_user %>
                <%= link_to 'Log Out', logout_path, method: :delete, data: { confirm: 'Are you sure you want to log out?' } %>
              </div>
            </button>
            
            <nav class="hidden-xxs">
              <%= link_to 'Recipes', recipes_path %>
              <%= link_to 'Users', users_path %>
              <%= link_to 'Me', current_user %>
              <%= link_to 'Log Out', logout_path, method: :delete, data: { confirm: 'Are you sure you want to log out?' } %>
            </nav>

            <%= link_to new_recipe_path, class: 'nav-button right' do %>
              <%= image_tag asset_path('add.png'), alt: 'New Recipe', title: 'New Recipe' %>
            <% end %>
          <% else %>
            <nav>
              <%= link_to 'Sign Up', signup_path %>
              <%= link_to 'Log In', login_path %>
            </nav>
          <% end %>
        </div>
        
      </div>
      <div class="clear"></div>
    </header>

    <% if @recipes %>
      <div id="search-bar">
        <div class="container">
          <div class="row">
            <%= form_with url: recipes_path, method: 'get', id: 'search_form' do |form| %>
              <div class="pretty-dropdown genre-filter">
                <%= form.select :genre, Recipe.genres, { include_blank: 'all genres' } %>
              </div>
              <%= hidden_field_tag :user, @user.id.to_s unless @user.nil? %>
              <div class="recipe-search">
                <%= form.text_field :search, value: params[:search], class: 'search-box' %>
                <%= form.submit '', name: nil, title: 'Search', class: 'search-button' %>
              </div>
            <% end %>
          </div>
        </div>
        <div class="clear"></div>
      </div>
    <% end %>

    <div id="top-spacer" class="spacer"></div>

    <div class="container">
      <% flash.each do |message_type, message| %>
        <div class="row">
          <div class="alert alert-<%= message_type %>"><%= message %></div>
        </div>
      <% end %>
    </div>

    <%= yield %>

    <footer>
      <div class="container">
        <div class="row">
          <p class="logo"><a href="https://github.com/devthered">A Website by Devin Reed</a></p>
        </div>
      </div>
      <div class="clear"></div>
    </footer>

  </body>

  <%= javascript_include_tag 'pretty-dropdowns.js' %>
  <%= javascript_include_tag 'pretty-textareas.js' %>
  <%= javascript_include_tag 'recipe-search.js' %>

</html>
